<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>MySql | Gordo</title><meta name="keywords" content="数据库,Database,mysql"><meta name="author" content="捕猹少年"><meta name="copyright" content="捕猹少年"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="MySql 索引（index）">
<meta property="og:type" content="article">
<meta property="og:title" content="MySql">
<meta property="og:url" content="https://gitee.com/zhangyangibm/zhangyangibm.git/2021/05/03/mysql%E6%95%B0%E6%8D%AE%E5%BA%93/index.html">
<meta property="og:site_name" content="Gordo">
<meta property="og:description" content="MySql 索引（index）">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gitee.com/zhangyangibm/zhangyangibm.git/img/mysql.png">
<meta property="article:published_time" content="2021-05-03T04:47:47.000Z">
<meta property="article:modified_time" content="2022-02-28T01:40:10.658Z">
<meta property="article:author" content="捕猹少年">
<meta property="article:tag" content="数据库">
<meta property="article:tag" content="Database">
<meta property="article:tag" content="mysql">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/zhangyangibm/zhangyangibm.git/img/mysql.png"><link rel="shortcut icon" href="/zhangyangibm/img/logo.png"><link rel="canonical" href="https://gitee.com/zhangyangibm/zhangyangibm.git/2021/05/03/mysql%E6%95%B0%E6%8D%AE%E5%BA%93/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/zhangyangibm/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/zhangyangibm/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'MySql',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-02-28 09:40:10'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.0.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/zhangyangibm/img/header.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/zhangyangibm/archives/"><div class="headline">文章</div><div class="length-num">16</div></a></div><div class="data-item"><a href="/zhangyangibm/tags/"><div class="headline">标签</div><div class="length-num">34</div></a></div><div class="data-item"><a href="/zhangyangibm/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/zhangyangibm/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/zhangyangibm/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间抽</span></a></div><div class="menus_item"><a class="site-page" href="/zhangyangibm/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/zhangyangibm/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/zhangyangibm/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/zhangyangibm/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/zhangyangibm/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/zhangyangibm/">Gordo</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/zhangyangibm/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/zhangyangibm/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间抽</span></a></div><div class="menus_item"><a class="site-page" href="/zhangyangibm/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/zhangyangibm/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/zhangyangibm/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/zhangyangibm/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/zhangyangibm/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">MySql</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-05-03T04:47:47.000Z" title="发表于 2021-05-03 12:47:47">2021-05-03</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-02-28T01:40:10.658Z" title="更新于 2022-02-28 09:40:10">2022-02-28</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/zhangyangibm/categories/%E6%96%87%E7%AB%A0/">文章</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/zhangyangibm/categories/%E6%96%87%E7%AB%A0/%E6%95%99%E7%A8%8B/">教程</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="MySql"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div><article class="post-content" id="article-container"><p>MySql 索引（index）</p>
<span id="more"></span>

<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>本次主要是对针对mysql索引部分，主要目的在实践，非理论。<br>mysql的安装很简单，本次不对安装进行过多的介绍，<br>mysql使用的版本是”Ver 14.14 Distrib 5.7.30 linux-glibc2.12 (x86_64) “ 。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost mysql]# mysql -V</span><br><span class="line">mysql  Ver 14.14 Distrib 5.7.30, for linux-glibc2.12 (x86_64) using  EditLine wrapper</span><br><span class="line">[root@localhost mysql]# </span><br></pre></td></tr></table></figure>

<h3 id="1、Join"><a href="#1、Join" class="headerlink" title="1、Join"></a>1、Join</h3><p>对于<strong>join</strong>的使用，如在百度中找到了一张图，结合图了解一下几种join，这里只做复习介绍。<br><img src="/zhangyangibm/mysql/0001.png" alt="mysql" title="mysql"></p>
<ul>
<li>inner join：是获取两个表中共有的部分；<br>select * from table_1 a inner join table_2 b on a.key &#x3D; b.key</li>
<li>left join：左边表的全部，右表的共有；<br>select * from table_1 a left join table_2 b on a.key &#x3D; b.key</li>
<li>right join：右边表的全部，左表的共有；<br>select * from table_1 a right join table_2 b on a.key &#x3D; b.key</li>
<li>左表独有<br>select * from table_1 a left join table_2 b on a.key &#x3D; b.key where <strong>b.key is null</strong></li>
<li>右表独有<br>select * from table_1 a right join table_2 b on a.key &#x3D; b.key where <strong>a.key is null</strong></li>
<li>左右共有<br>select * from table_1 a left <strong>full outer join</strong> table_2 b on a.key &#x3D; b.key</li>
<li>排除共有<br>select * from table_1 a left <strong>full outer join</strong> table_2 b on a.key &#x3D; b.key where a.key <strong>is null</strong> or b.key is null</li>
</ul>
<h3 id="2、index"><a href="#2、index" class="headerlink" title="2、index"></a>2、index</h3><p>mysql对索引的处理是B+Tree，本次重点不是原理，而是针对应用，提高查询的效率，并实现对索引的优化。</p>
<h4 id="2-1、索引的优势和劣势："><a href="#2-1、索引的优势和劣势：" class="headerlink" title="2.1、索引的优势和劣势："></a>2.1、索引的优势和劣势：</h4><ul>
<li>优势<br>可以提高数据的检索效率，降低数据库的IO成本；<br>通过索引对数据进行排序，降低数据的排序成本，降低CPU的消耗。</li>
<li>劣势<br>实际上使用索引会占用空间，因此在索引创建要准确，不要多。<br>索引索然提高了检索的效率，但是对insert和update时，mysql不仅要保存数据，而且每次还要保存索引文件所在的添加了索引列的字段，会增加除了检索外其他操作的负担。<br>索引的建立需要细致的斟酌和思考，好的索引需要耗时很长的时间。</li>
</ul>
<h4 id="2-2、索引分类"><a href="#2-2、索引分类" class="headerlink" title="2.2、索引分类"></a>2.2、索引分类</h4><p>单值索引（一个索引只包含单个列），<br>复合索引（一个索引包含着多个列），<br>唯一索引（索引列的值必须唯一，单允许有空值）</p>
<h4 id="2-3、基本语法"><a href="#2-3、基本语法" class="headerlink" title="2.3、基本语法"></a>2.3、基本语法</h4><ul>
<li>创建<br>create [unique]index 索引名 on table_name(columname(length))；<br>alter table_name add [unique] index 索引名 on columname(length)；</li>
<li>删除<br>drop index 索引名 on table_name；</li>
<li>查看<br>show index from table_name</li>
</ul>
<h3 id="3、性能分析"><a href="#3、性能分析" class="headerlink" title="3、性能分析"></a>3、性能分析</h3><p>基于Explain语句对操作sql进行分析</p>
<p>首先先查看当前数据库有哪些表：<br>select table_name from information_schema.tables where table_schema&#x3D;’当前数据库’</p>
<p>创建几张新表：<br>–工资表<br>CREATE TABLE t1<br>(<br>id int,<br>CN varchar(255),<br>JC varchar(255),<br>Address varchar(255),<br>City varchar(255)<br>);</p>
<p>–员工表<br>CREATE TABLE t2<br>(<br>id int,<br>PN varchar(255),<br>AG int,<br>job varchar(255),<br>Address varchar(255),<br>City varchar(255),<br>t1_id int<br>);</p>
<p>–员工兴趣表<br>CREATE TABLE t3<br>(<br>id int,<br>PN varchar(255),<br>AG varchar(255),<br>BM varchar(255),<br>INFO varchar(255),<br>t2_id int<br>);</p>
<p><strong>执行explan语句</strong>先看一下几个项目：<br><img src="/zhangyangibm/mysql/0002.png" alt="mysql" title="mysql"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; explain select * from t1;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------+</span><br><span class="line">| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------+</span><br><span class="line">|  1 | SIMPLE      | t1    | NULL       | ALL  | NULL          | NULL | NULL    | NULL |    1 |   100.00 | NULL  |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br></pre></td></tr></table></figure>

<ul>
<li>id<br>执行一段sql，对应说明explain各个字段表示什么意思。<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; explain select t2.* from t1,t2,t3 where t1.id=t2.id and t1.id = t3.id;</span><br><span class="line">+----+-------------+-------+------------+--------+---------------+---------+---------+-------------+------+----------+-------------+</span><br><span class="line">| id | select_type | table | partitions | type   | possible_keys | key     | key_len | ref         | rows | filtered | Extra       |</span><br><span class="line">+----+-------------+-------+------------+--------+---------------+---------+---------+-------------+------+----------+-------------+</span><br><span class="line">|  1 | SIMPLE      | t2    | NULL       | ALL    | PRIMARY       | NULL    | NULL    | NULL        |    8 |   100.00 | NULL        |</span><br><span class="line">|  1 | SIMPLE      | t1    | NULL       | eq_ref | PRIMARY       | PRIMARY | 4       | mango.t2.id |    1 |   100.00 | Using index |</span><br><span class="line">|  1 | SIMPLE      | t3    | NULL       | eq_ref | PRIMARY       | PRIMARY | 4       | mango.t2.id |    1 |   100.00 | Using index |</span><br><span class="line">+----+-------------+-------+------------+--------+---------------+---------+---------+-------------+------+----------+-------------+</span><br><span class="line">3 rows in set, 1 warning (0.00 sec)</span><br></pre></td></tr></table></figure>
id:当id相同的情况下，table执行的顺序从上之下。</li>
</ul>
<p>执行sql：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; EXPLAIN SELECT * FROM t2 WHERE id = (SELECT id FROM t1 WHERE id = (SELECT id FROM t3 WHERE id  = &#x27;8&#x27;));</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+-------+------+----------+-------------+</span><br><span class="line">| id | select_type | table | partitions | type  | possible_keys | key     | key_len | ref   | rows | filtered | Extra       |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+-------+------+----------+-------------+</span><br><span class="line">|  1 | PRIMARY     | t2    | NULL       | const | PRIMARY       | PRIMARY | 4       | const |    1 |   100.00 | NULL        |</span><br><span class="line">|  2 | SUBQUERY    | t1    | NULL       | const | PRIMARY       | PRIMARY | 4       | const |    1 |   100.00 | Using index |</span><br><span class="line">|  3 | SUBQUERY    | t3    | NULL       | const | PRIMARY       | PRIMARY | 4       | const |    1 |   100.00 | Using index |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+-------+------+----------+-------------+</span><br><span class="line">3 rows in set, 1 warning (0.00 sec)</span><br></pre></td></tr></table></figure>
<p>id:当id不同的情况下，id值大的先执行。</p>
<ul>
<li>select_type:查询的类型，包含一下几点：</li>
</ul>
<p><strong>SIMPLE</strong>：简单查询,查询中不包含自查询&#x2F;union<br><strong>PRIMARY</strong>：主键查询<br><strong>SUBQUERY</strong>：子查询<br><strong>DERIVED</strong>：延伸查询，在from的查询列表中标记为DERIVED，mysql会递归执行这些子查询，把结果放在临时表中。<br>EXPLAIN SELECT t2.* FROM (SELECT t3.id FROM t3) s1,t2 WHERE s1.id &#x3D; t2.id;<br><strong>UNION</strong>：联合查询</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; explain select * from t1 union select * from t4;</span><br><span class="line">+----+--------------+------------+------------+------+---------------+------+---------+------+------+----------+-----------------+</span><br><span class="line">| id | select_type  | table      | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra           |</span><br><span class="line">+----+--------------+------------+------------+------+---------------+------+---------+------+------+----------+-----------------+</span><br><span class="line">|  1 | PRIMARY      | t1         | NULL       | ALL  | NULL          | NULL | NULL    | NULL |    8 |   100.00 | NULL            |</span><br><span class="line">|  2 | UNION        | t4         | NULL       | ALL  | NULL          | NULL | NULL    | NULL |    8 |   100.00 | NULL            |</span><br><span class="line">| NULL | UNION RESULT | &lt;union1,2&gt; | NULL       | ALL  | NULL          | NULL | NULL    | NULL | NULL |     NULL | Using temporary |</span><br><span class="line">+----+--------------+------------+------------+------+---------------+------+---------+------+------+----------+-----------------+</span><br><span class="line">3 rows in set, 1 warning (0.00 sec)</span><br></pre></td></tr></table></figure>
<p><strong>UNION RESULT</strong>：从UNION表获取结果的select</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; explain select * from t1 a left join t2 b on a.id=b.id</span><br><span class="line">    -&gt; union</span><br><span class="line">    -&gt; select * from t1 a RIGHT join t2 b on a.id=b.id;</span><br><span class="line">+----+--------------+------------+------------+--------+---------------+---------+---------+------------+------+----------+-----------------+</span><br><span class="line">| id | select_type  | table      | partitions | type   | possible_keys | key     | key_len | ref        | rows | filtered | Extra           |</span><br><span class="line">+----+--------------+------------+------------+--------+---------------+---------+---------+------------+------+----------+-----------------+</span><br><span class="line">|  1 | PRIMARY      | a          | NULL       | ALL    | NULL          | NULL    | NULL    | NULL       |    8 |   100.00 | NULL            |</span><br><span class="line">|  1 | PRIMARY      | b          | NULL       | eq_ref | PRIMARY       | PRIMARY | 4       | mango.a.id |    1 |   100.00 | NULL            |</span><br><span class="line">|  2 | UNION        | b          | NULL       | ALL    | NULL          | NULL    | NULL    | NULL       |    8 |   100.00 | NULL            |</span><br><span class="line">|  2 | UNION        | a          | NULL       | eq_ref | PRIMARY       | PRIMARY | 4       | mango.b.id |    1 |   100.00 | NULL            |</span><br><span class="line">| NULL | UNION RESULT | &lt;union1,2&gt; | NULL       | ALL    | NULL          | NULL    | NULL    | NULL       | NULL |     NULL | Using temporary |</span><br><span class="line">+----+--------------+------------+------------+--------+---------------+---------+---------+------------+------+----------+-----------------+</span><br><span class="line">5 rows in set, 1 warning (0.01 sec)</span><br></pre></td></tr></table></figure>

<ul>
<li>table:表名</li>
<li>partitions：</li>
<li>type:有以下几种类型，优化程度排序system&gt;const&gt;eq_ref&gt;ref&gt;range&gt;index&gt;ALL，在实际开发中到range和ref的级别</li>
</ul>
<p><strong>ALL</strong>:全表扫描<br><strong>index</strong>：full index scan，index于all的区别为index类型只遍历索引树，虽然都是全表扫描但是index读树，all读磁盘。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">主键检索</span><br><span class="line">mysql&gt; explain select id from t1;</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">| id | select_type | table | partitions | type  | possible_keys | key  | key_len | ref  | rows | filtered | Extra       |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">|  1 | SIMPLE      | t1    | NULL       | index | NULL          | cnjc | 1536    | NULL |    8 |   100.00 | Using index |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br><span class="line"></span><br><span class="line">检索指定列</span><br><span class="line">mysql&gt; explain select cn from t1;</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">| id | select_type | table | partitions | type  | possible_keys | key  | key_len | ref  | rows | filtered | Extra       |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">|  1 | SIMPLE      | t1    | NULL       | index | NULL          | cnjc | 1536    | NULL |    8 |   100.00 | Using index |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; explain select cn,jc from t1;</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">| id | select_type | table | partitions | type  | possible_keys | key  | key_len | ref  | rows | filtered | Extra       |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">|  1 | SIMPLE      | t1    | NULL       | index | NULL          | cnjc | 1536    | NULL |    8 |   100.00 | Using index |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br><span class="line"></span><br><span class="line">检索所有列 select * 的type为All</span><br><span class="line">mysql&gt; explain select * from t1;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------+</span><br><span class="line">| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------+</span><br><span class="line">|  1 | SIMPLE      | t1    | NULL       | ALL  | NULL          | NULL | NULL    | NULL |    8 |   100.00 | NULL  |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>range</strong>：只检索范围的行，使用一个索引来选择，在“key”列会显示使用了哪个索引。一般就是在where语句中出现，bewteen，&lt;,&gt;,in等的查询，范围扫描一般好于全部扫描。<br>查看表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from t2;</span><br><span class="line">+----+------+------+------+----------+--------+-------+</span><br><span class="line">| id | PN   | AG   | job  | Address  | City   | t1_id |</span><br><span class="line">+----+------+------+------+----------+--------+-------+</span><br><span class="line">|  1 | p001 | 12   | it   | liaoning | dalian |  NULL |</span><br><span class="line">|  2 | p002 | 11   | it   | liaoning | dalian |  NULL |</span><br><span class="line">|  3 | p003 | 21   | it   | liaoning | dalian |  NULL |</span><br><span class="line">|  4 | p004 | 23   | it   | liaoning | dalian |  NULL |</span><br><span class="line">|  5 | p005 | 24   | it   | liaoning | dalian |  NULL |</span><br><span class="line">|  6 | p006 | 25   | it   | liaoning | dalian |  NULL |</span><br><span class="line">|  7 | p007 | 27   | it   | liaoning | dalian |  NULL |</span><br><span class="line">|  8 | p008 | 20   | it   | liaoning | dalian |  NULL |</span><br><span class="line">+----+------+------+------+----------+--------+-------+</span><br></pre></td></tr></table></figure>
<p>对ag设定索引<br>mysql&gt; create index ag on t2(ag);<br>Query OK, 0 rows affected (0.33 sec)<br>Records: 0  Duplicates: 0  Warnings: 0</p>
<p>对ag列试行范围查询</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; explain select * from t2 where ag between 12 and 20;</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+------+---------+------+------+----------+-----------------------+</span><br><span class="line">| id | select_type | table | partitions | type  | possible_keys | key  | key_len | ref  | rows | filtered | Extra                 |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+------+---------+------+------+----------+-----------------------+</span><br><span class="line">|  1 | SIMPLE      | t2    | NULL       | range | ag            | ag   | 5       | NULL |    2 |   100.00 | Using index condition |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+------+---------+------+------+----------+-----------------------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br></pre></td></tr></table></figure>
<p>mysql&gt;</p>
<p><strong>ref</strong>：非唯一索引扫描，返回值匹配某个单独值的所有行，其本质也是索引查询。<br>创建联合索引<br>mysql&gt; create index cnjc on t1(cn,jc);<br>Query OK, 0 rows affected (0.31 sec)<br>Records: 0  Duplicates: 0  Warnings: 0</p>
<p>测试索引查询</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; explain select * from t1 where cn=&#x27;c001&#x27;;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+-------+------+----------+-------+</span><br><span class="line">| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref   | rows | filtered | Extra |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+-------+------+----------+-------+</span><br><span class="line">|  1 | SIMPLE      | t1    | NULL       | ref  | cnjc          | cnjc | 768     | const |    1 |   100.00 | NULL  |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+-------+------+----------+-------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; explain select * from t2 where id in(1,3,5);</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-------------+</span><br><span class="line">| id | select_type | table | partitions | type  | possible_keys | key     | key_len | ref  | rows | filtered | Extra       |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-------------+</span><br><span class="line">|  1 | SIMPLE      | t2    | NULL       | range | PRIMARY       | PRIMARY | 4       | NULL |    3 |   100.00 | Using where |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-------------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>eq_ref</strong>：唯一性索引扫描，对于每一个索引键，表中只有一条数据与之匹配，常用于主键或者唯一索引扫描。<br>假设一个表中有一条记录，另一张表有多条记录，关联查询主键关联查询时：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select 1 from tb_user;</span><br><span class="line">+---+</span><br><span class="line">| 1 |</span><br><span class="line">+---+</span><br><span class="line">| 1 |</span><br><span class="line">+---+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; explain select * from tb_user,t1 where tb_user.id=t1.id;</span><br><span class="line">+----+-------------+---------+------------+--------+---------------+---------+---------+------------------+------+----------+-------+</span><br><span class="line">| id | select_type | table   | partitions | type   | possible_keys | key     | key_len | ref              | rows | filtered | Extra |</span><br><span class="line">+----+-------------+---------+------------+--------+---------------+---------+---------+------------------+------+----------+-------+</span><br><span class="line">|  1 | SIMPLE      | tb_user | NULL       | ALL    | PRIMARY,key   | NULL    | NULL    | NULL             |    1 |   100.00 | NULL  |</span><br><span class="line">|  1 | SIMPLE      | t1      | NULL       | eq_ref | PRIMARY       | PRIMARY | 4       | mango.tb_user.id |    1 |   100.00 | NULL  |</span><br><span class="line">+----+-------------+---------+------------+--------+---------------+---------+---------+------------------+------+----------+-------+</span><br><span class="line">2 rows in set, 1 warning (0.00 sec)</span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>
<p>2 rows in set, 1 warning (0.00 sec)<br><strong>const</strong>：表示通过索引一次就能找到，常出现在主键索引和唯一索引（UNIQUE），因为只匹配一行记录，所以很快将主键置于where列表中，mysql就可以将查询转化为一个常量。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; explain select * from tb_user where id =6;</span><br><span class="line">+----+-------------+---------+------------+-------+---------------+---------+---------+-------+------+----------+-------+</span><br><span class="line">| id | select_type | table   | partitions | type  | possible_keys | key     | key_len | ref   | rows | filtered | Extra |</span><br><span class="line">+----+-------------+---------+------------+-------+---------------+---------+---------+-------+------+----------+-------+</span><br><span class="line">|  1 | SIMPLE      | tb_user | NULL       | const | PRIMARY,key   | PRIMARY | 4       | const |    1 |   100.00 | NULL  |</span><br><span class="line">+----+-------------+---------+------------+-------+---------------+---------+---------+-------+------+----------+-------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br></pre></td></tr></table></figure>
<p><strong>system</strong>：表只有一条记录,基本上相当于mysql系统表</p>
<ul>
<li>possible_keys:可能会用到哪些索引显示可能在应用在表中的索引，一个或者多个，查询字段上如果存在索引将会被列出，但是不一定实际使用。</li>
<li>key:实际用到的索引</li>
</ul>
<p>**案例1:**首先t2表为例，进行对比。<br>查询t2表中现有的索引有ag和id<br>mysql&gt; show index from t2;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span><br><span class="line">| Table | Non_unique | Key_name | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment |</span><br><span class="line">+-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span><br><span class="line">| t2    |          0 | PRIMARY  |            1 | id          | A         |           8 |     NULL | NULL   |      | BTREE      |         |               |</span><br><span class="line">| t2    |          1 | ag       |            1 | AG          | A         |           8 |     NULL | NULL   | YES  | BTREE      |         |               |</span><br><span class="line">+-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<p>索引查询：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; explain select * from t2 where ag between 11 and 20;</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+------+---------+------+------+----------+-----------------------+</span><br><span class="line">| id | select_type | table | partitions | type  | possible_keys | key  | key_len | ref  | rows | filtered | Extra                 |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+------+---------+------+------+----------+-----------------------+</span><br><span class="line">|  1 | SIMPLE      | t2    | NULL       | range | ag            | ag   | 5       | NULL |    3 |   100.00 | Using index condition |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+------+---------+------+------+----------+-----------------------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br></pre></td></tr></table></figure>
<p>显示possible_keys可能用到的索引是ag，实际也是根据索引进行查询的因此key显示“ag”,但是当where条件不是根据索引进行查询的的话会显示：NULL，这就是<strong>索引失效</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; explain select pn from t2 where job=&#x27;it&#x27;;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra       |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">|  1 | SIMPLE      | t2    | NULL       | ALL  | NULL          | NULL | NULL    | NULL |    8 |    12.50 | Using where |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br></pre></td></tr></table></figure>
<p>索引失效还有一种体现：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; explain select ag,pn from t2;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------+</span><br><span class="line">| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------+</span><br><span class="line">|  1 | SIMPLE      | t2    | NULL       | ALL  | NULL          | NULL | NULL    | NULL |    8 |   100.00 | NULL  |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br></pre></td></tr></table></figure>
<p>检索内容同时包含索引列和非索引类的时候，也会发生索引失效。</p>
<p>**案例2:**复合索引<br>t1表中使用了复合索引</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show index from t1;</span><br><span class="line">+-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span><br><span class="line">| Table | Non_unique | Key_name | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment |</span><br><span class="line">+-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span><br><span class="line">| t1    |          0 | PRIMARY  |            1 | id          | A         |           8 |     NULL | NULL   |      | BTREE      |         |               |</span><br><span class="line">| t1    |          1 | cnjc     |            1 | CN          | A         |           8 |     NULL | NULL   | YES  | BTREE      |         |               |</span><br><span class="line">| t1    |          1 | cnjc     |            2 | JC          | A         |           8 |     NULL | NULL   | YES  | BTREE      |         |               |</span><br><span class="line">+-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span><br><span class="line"></span><br><span class="line">3 rows in set (0.00 sec)</span><br><span class="line">mysql&gt; explain select * from t1 where cn =&#x27;c001&#x27;;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+-------+------+----------+-------+</span><br><span class="line">| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref   | rows | filtered | Extra |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+-------+------+----------+-------+</span><br><span class="line">|  1 | SIMPLE      | t1    | NULL       | ref  | cnjc          | cnjc | 768     | const |    1 |   100.00 | NULL  |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+-------+------+----------+-------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>案例3</strong>:可能用不到，但是实际用到了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; explain select ag from t2;</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">| id | select_type | table | partitions | type  | possible_keys | key  | key_len | ref  | rows | filtered | Extra       |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">|  1 | SIMPLE      | t2    | NULL       | index | NULL          | ag   | 5       | NULL |    8 |   100.00 | Using index |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br></pre></td></tr></table></figure>
<p>查询中是索引项目，此时possible_keys显示null，用不到索引，但是实际上key显示ag，用到了索引。这种情况就是：<strong>检索的字段于索引字段吻合</strong>。</p>
<ul>
<li>key_len:表示索引中使用的字节数，可根据该列计算查询中使用的索引长度。在不失去精度的情况下，长度越短越好。<br>key_len显示的值是索引字段的最大可能长度，并非实际长度，key_len是根据表的定义计算得出的。</li>
</ul>
<p>索引查询<br>当检索条件只有一个值的时候key_len&#x3D;768</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; explain select * from t1 where cn=&#x27;c001&#x27;;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+-------+------+----------+-------+</span><br><span class="line">| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref   | rows | filtered | Extra |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+-------+------+----------+-------+</span><br><span class="line">|  1 | SIMPLE      | t1    | NULL       | ref  | cnjc          | cnjc | 768     | const |    1 |   100.00 | NULL  |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+-------+------+----------+-------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br></pre></td></tr></table></figure>
<p>当检索条件被细化之后,在加一个索引检索项目时，key_len&#x3D;1536</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; explain select * from t1 where cn=&#x27;c001&#x27; and jc=&#x27;j001&#x27;;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+-------------+------+----------+-------+</span><br><span class="line">| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref         | rows | filtered | Extra |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+-------------+------+----------+-------+</span><br><span class="line">|  1 | SIMPLE      | t1    | NULL       | ref  | cnjc          | cnjc | 1536    | const,const |    1 |   100.00 | NULL  |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+-------------+------+----------+-------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br></pre></td></tr></table></figure>
<ul>
<li><p>ref:显示索引的哪一列被使用,哪些值或者常量被用于索引查询。<br>执行sql</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; explain select * from tb_user,t1 where tb_user.id=t1.id and cn=&#x27;c001&#x27;;</span><br><span class="line">+----+-------------+---------+------------+--------+---------------+---------+---------+------------------+------+----------+-------------+</span><br><span class="line">| id | select_type | table   | partitions | type   | possible_keys | key     | key_len | ref              | rows | filtered | Extra       |</span><br><span class="line">+----+-------------+---------+------------+--------+---------------+---------+---------+------------------+------+----------+-------------+</span><br><span class="line">|  1 | SIMPLE      | tb_user | NULL       | ALL    | PRIMARY,key   | NULL    | NULL    | NULL             |    1 |   100.00 | NULL        |</span><br><span class="line">|  1 | SIMPLE      | t1      | NULL       | eq_ref | PRIMARY,cnjc  | PRIMARY | 4       | mango.tb_user.id |    1 |    12.50 | Using where |</span><br><span class="line">+----+-------------+---------+------------+--------+---------------+---------+---------+------------------+------+----------+-------------+</span><br></pre></td></tr></table></figure>
<p>分析：<br>id相同顺序执行，where tb_user.id&#x3D;t1.id and cn&#x3D;’c001’;<br>第一条：执行的是“tb_user.id&#x3D;t1.id”，可能用到的索引是PRIMARY,key ，但是实际没用用到key&#x3D;null，第一个条件没有用到索引，ref显示NULL。<br>第二条：执行的是“cn&#x3D;’c001’”，可能用到的索引是PRIMARY,cnjc ，实际用到是PRIMARY，用作常量查询，ref显示被用到这个mango.tb_user.id这个字段</p>
</li>
<li><p>rows:大致估算满足条件所需要的行数。换句话说，显示“每张表有多少数据被优化器查询”。rows越小越好</p>
</li>
</ul>
<p>对比以下两个sql<br>t1,t4,t6，表结构一致，t4,t6没有索引，t1复合索引cn和jn<br>没有索引的情况下检索rows 8+1&#x3D;9</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; explain select * from t4,t6 where t4.id = t6.id and t4.cn=&#x27;c001&#x27;;</span><br><span class="line">+----+-------------+-------+------------+--------+---------------+---------+---------+-------------+------+----------+-------------+</span><br><span class="line">| id | select_type | table | partitions | type   | possible_keys | key     | key_len | ref         | rows | filtered | Extra       |</span><br><span class="line">+----+-------------+-------+------------+--------+---------------+---------+---------+-------------+------+----------+-------------+</span><br><span class="line">|  1 | SIMPLE      | t4    | NULL       | ALL    | PRIMARY       | NULL    | NULL    | NULL        |    8 |    12.50 | Using where |</span><br><span class="line">|  1 | SIMPLE      | t6    | NULL       | eq_ref | PRIMARY       | PRIMARY | 4       | mango.t4.id |    1 |   100.00 | NULL        |</span><br><span class="line">+----+-------------+-------+------------+--------+---------------+---------+---------+-------------+------+----------+-------------+</span><br><span class="line">2 rows in set, 1 warning (0.00 sec)</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">存在索引的情况下rows 1+1=2</span><br><span class="line">mysql&gt; explain select * from t1,t6 where t1.id = t6.id and t1.cn=&#x27;c001&#x27;;</span><br><span class="line">+----+-------------+-------+------------+--------+---------------+---------+---------+-------------+------+----------+-------+</span><br><span class="line">| id | select_type | table | partitions | type   | possible_keys | key     | key_len | ref         | rows | filtered | Extra |</span><br><span class="line">+----+-------------+-------+------------+--------+---------------+---------+---------+-------------+------+----------+-------+</span><br><span class="line">|  1 | SIMPLE      | t1    | NULL       | ref    | PRIMARY,cnjc  | cnjc    | 768     | const       |    1 |   100.00 | NULL  |</span><br><span class="line">|  1 | SIMPLE      | t6    | NULL       | eq_ref | PRIMARY       | PRIMARY | 4       | mango.t1.id |    1 |   100.00 | NULL  |</span><br><span class="line">+----+-------------+-------+------------+--------+---------------+---------+---------+-------------+------+----------+-------+</span><br><span class="line">2 rows in set, 1 warning (0.01 sec)</span><br></pre></td></tr></table></figure>
<ul>
<li>Extra:</li>
</ul>
<p><strong>Using filesort:文件内排序</strong><br><img src="/zhangyangibm/mysql/0004.png" alt="mysql" title="mysql"><br>第二个sql，T1表存在一个复合索引，nc和jc,在排序的时候使用的是order by city，这个时候会发现：<br>Extra显示Using index condition; Using filesort<br>Using index condition说明在sql中使用到了索引检索<br>Using filesort说明出现了文件内排序，出现这个问题主要原因是在order by city，并没有使用到索引字段，导致在查询时，mysql进行了优化，自我完成了另一部分的排序。</p>
<p><strong>创建索引时检索和排序是有关联的，如果需要order by排序，那么最好将索引列包含其中</strong><br>直白的说就是，有索引要排序，排序列再要全部包含索引字段，只要存在一个非索引字段就会产生Using filesort<br><img src="/zhangyangibm/mysql/0005.png" alt="mysql" title="mysql"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; explain select cn from T1 a where a.cn =&#x27;c001&#x27; order by jc;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+-------+------+----------+--------------------------+</span><br><span class="line">| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref   | rows | filtered | Extra                    |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+-------+------+----------+--------------------------+</span><br><span class="line">|  1 | SIMPLE      | a     | NULL       | ref  | cnjc          | cnjc | 768     | const |    3 |   100.00 | Using where; Using index |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+-------+------+----------+--------------------------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>Using temporary:</strong><br>mysql在对查询结果排序的时候产生了临时表。常见于order by和group by</p>
<p><strong>Using index:</strong><br>表示相应的select操作的中使用了覆盖索引，避免了访问表的数据行，效率有所提升。<br>查询条件和创建的索引一致, 如果同时出现了Using where，表明索引被用来执行索引键值的查找。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; explain select cn,jc from T1 a where a.cn in (&#x27;c001&#x27;,&#x27;c002&#x27;,&#x27;c005&#x27;) ;</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+------+---------+------+------+----------+--------------------------+</span><br><span class="line">| id | select_type | table | partitions | type  | possible_keys | key  | key_len | ref  | rows | filtered | Extra                    |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+------+---------+------+------+----------+--------------------------+</span><br><span class="line">|  1 | SIMPLE      | a     | NULL       | range | cnjc          | cnjc | 768     | NULL |    5 |   100.00 | Using where; Using index |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+------+---------+------+------+----------+--------------------------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br></pre></td></tr></table></figure>
<p>检索的内容和索引一致</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; explain select cn,jc from T1 a ;</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">| id | select_type | table | partitions | type  | possible_keys | key  | key_len | ref  | rows | filtered | Extra       |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">|  1 | SIMPLE      | a     | NULL       | index | NULL          | cnjc | 1536    | NULL |    8 |   100.00 | Using index |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br></pre></td></tr></table></figure>
<h4 id="2-4、避免索引失效"><a href="#2-4、避免索引失效" class="headerlink" title="2.4、避免索引失效"></a>2.4、避免索引失效</h4><ul>
<li><p>事例1:<br>t1表中有两个索引</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show index from t1;</span><br><span class="line">+-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span><br><span class="line">| Table | Non_unique | Key_name | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment |</span><br><span class="line">+-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span><br><span class="line">| t1    |          0 | PRIMARY  |            1 | id          | A         |           8 |     NULL | NULL   |      | BTREE      |         |               |</span><br><span class="line">| t1    |          1 | cnjc     |            1 | CN          | A         |           8 |     NULL | NULL   | YES  | BTREE      |         |               |</span><br><span class="line">| t1    |          1 | cnjc     |            2 | JC          | A         |           8 |     NULL | NULL   | YES  | BTREE      |         |               |</span><br><span class="line">+-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from t1 where t1.cn= &#x27;c001&#x27;;</span><br><span class="line">+----+------+------+-----------------+----------+</span><br><span class="line">| id | CN   | JC   | Address         | City     |</span><br><span class="line">+----+------+------+-----------------+----------+</span><br><span class="line">|  1 | c001 | j001 | liaoning        | shenyang |</span><br><span class="line">|  7 | c001 | j008 | liaoning        | liaoning |</span><br><span class="line">|  8 | c001 | j009 | liaoning dalian | liaoning |</span><br><span class="line">+----+------+------+-----------------+----------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>如果创建了索引，尽可能根据索引列，进行检索<br>select * from t1 where t1.cn&#x3D; ‘c001’;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; explain select * from t1 where t1.cn= &#x27;c001&#x27;;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+-------+------+----------+-------+</span><br><span class="line">| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref   | rows | filtered | Extra |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+-------+------+----------+-------+</span><br><span class="line">|  1 | SIMPLE      | t1    | NULL       | ref  | cnjc          | cnjc | 768     | const |    3 |   100.00 | NULL  |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+-------+------+----------+-------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; explain select * from t1 where t1.cn=&#x27;c001&#x27; and jc=&#x27;j001&#x27;;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+-------------+------+----------+-------+</span><br><span class="line">| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref         | rows | filtered | Extra |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+-------------+------+----------+-------+</span><br><span class="line">|  1 | SIMPLE      | t1    | NULL       | ref  | cnjc          | cnjc | 1536    | const,const |    1 |   100.00 | NULL  |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+-------------+------+----------+-------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br></pre></td></tr></table></figure></li>
<li><p>最佳左检索前缀法则,按照创建索引的顺序进行查询。</p>
</li>
<li><p>尽可能不要在索引列上做任何操作，（计算，函数，数据类型的转换），会导致索引失效，导致全表扫描。<br>注意：如果当前字段是字符类型，但是存储的是数字，可以省去单引号进行检索，但是一定要加上单引号，因为mysql底层会进行数据优化，默认加上单引号，也会给数据库增加负担。<br>num varchar（50）；<br>select * from t1 where ti.num &#x3D; ‘12434’</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; explain select * from t1 where left(t1.cn,1)=&#x27;c&#x27;;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra       |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">|  1 | SIMPLE      | t1    | NULL       | ALL  | NULL          | NULL | NULL    | NULL |    8 |   100.00 | Using where |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br></pre></td></tr></table></figure></li>
<li><p>存储引擎不能使用索引中范围条件右边的列。<br><img src="/zhangyangibm/mysql/0006.png" alt="mysql" title="mysql"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; explain select * from t2 where pn =&#x27;c001&#x27; and ag=20 and job =&#x27;it&#x27;;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+---------+---------+-------------------+------+----------+-------+</span><br><span class="line">| id | select_type | table | partitions | type | possible_keys | key     | key_len | ref               | rows | filtered | Extra |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+---------+---------+-------------------+------+----------+-------+</span><br><span class="line">|  1 | SIMPLE      | t2    | NULL       | ref  | pnagjob       | pnagjob | 1541    | const,const,const |    1 |   100.00 | NULL  |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+---------+---------+-------------------+------+----------+-------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; explain select * from t2 where pn =&#x27;c001&#x27; and ag&gt;20 and job =&#x27;it&#x27;;</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-----------------------+</span><br><span class="line">| id | select_type | table | partitions | type  | possible_keys | key     | key_len | ref  | rows | filtered | Extra                 |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-----------------------+</span><br><span class="line">|  1 | SIMPLE      | t2    | NULL       | range | pnagjob       | pnagjob | 773     | NULL |    1 |    12.50 | Using index condition |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-----------------------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br></pre></td></tr></table></figure>
<p>sql1:mysql&gt; explain select * from t2 where pn &#x3D;’c001’ and ag&#x3D;20 and job &#x3D;’it’;<br>sql2:mysql&gt; explain select * from t2 where pn &#x3D;’c001’ and ag&gt;20 and job &#x3D;’it’;<br>因为在检索条件中索引ag使用了范围检索，索引job就会失效，如图整个sql性能会降低。</p>
</li>
<li><p>检索的内容按需获取。尽可能不实用select *<br><img src="/zhangyangibm/mysql/0007.png" alt="mysql" title="mysql"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; explain select * from t2 where pn =&#x27;c001&#x27; and ag=20 and job =&#x27;it&#x27;;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+---------+---------+-------------------+------+----------+-------+</span><br><span class="line">| id | select_type | table | partitions | type | possible_keys | key     | key_len | ref               | rows | filtered | Extra |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+---------+---------+-------------------+------+----------+-------+</span><br><span class="line">|  1 | SIMPLE      | t2    | NULL       | ref  | pnagjob       | pnagjob | 1541    | const,const,const |    1 |   100.00 | NULL  |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+---------+---------+-------------------+------+----------+-------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; explain select pn,ag,job,city from t2 where pn =&#x27;c001&#x27; and ag=20 and job =&#x27;it&#x27;;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+---------+---------+-------------------+------+----------+-------+</span><br><span class="line">| id | select_type | table | partitions | type | possible_keys | key     | key_len | ref               | rows | filtered | Extra |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+---------+---------+-------------------+------+----------+-------+</span><br><span class="line">|  1 | SIMPLE      | t2    | NULL       | ref  | pnagjob       | pnagjob | 1541    | const,const,const |    1 |   100.00 | NULL  |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+---------+---------+-------------------+------+----------+-------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; explain select pn,ag,job from t2 where pn =&#x27;c001&#x27; and ag=20 and job =&#x27;it&#x27;;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+---------+---------+-------------------+------+----------+-------------+</span><br><span class="line">| id | select_type | table | partitions | type | possible_keys | key     | key_len | ref               | rows | filtered | Extra       |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+---------+---------+-------------------+------+----------+-------------+</span><br><span class="line">|  1 | SIMPLE      | t2    | NULL       | ref  | pnagjob       | pnagjob | 1541    | const,const,const |    1 |   100.00 | Using index |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+---------+---------+-------------------+------+----------+-------------+</span><br><span class="line">1 row in set, 1 warning (0.01 sec)</span><br></pre></td></tr></table></figure>
<p>sql1: mysql&gt; explain select * from t2 where pn &#x3D;’c001’ and ag&#x3D;20 and job &#x3D;’it’;<br>sql2: mysql&gt; explain select pn,ag,job,city from t2 where pn &#x3D;’c001’ and ag&#x3D;20 and job &#x3D;’it’;<br>sql3: mysql&gt; explain select pn,ag,job from t2 where pn &#x3D;’c001’ and ag&#x3D;20 and job &#x3D;’it’;</p>
</li>
</ul>
<p>sql1使用select * from  Extra显示Null<br>sql2使用select pn,ag,job,city 但是city不是索引列 Extra显示Null<br><strong>sql3</strong>使用索引查询索引检索 Extra显示 <strong>Using index</strong><br>在这种情况下，如果要是使用范围检索，效率也会有一定的提升<br>mysql&gt; explain select pn,ag,job from t2 where pn &#x3D;’c001’ and ag&gt;20 and job &#x3D;’it’;</p>
<ul>
<li>在mysql中使用！&#x3D;或者 &lt;&gt; 不等于的时候，无法使用索引会导致全表扫描<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; explain select pn,ag,job from t2 where pn !=&#x27;c001&#x27;;</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+--------------------------+</span><br><span class="line">| id | select_type | table | partitions | type  | possible_keys | key     | key_len | ref  | rows | filtered | Extra                    |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+--------------------------+</span><br><span class="line">|  1 | SIMPLE      | t2    | NULL       | index | pnagjob       | pnagjob | 1541    | NULL |    8 |   100.00 | Using where; Using index |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+--------------------------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; explain select pn,ag,job from t2 where pn =&#x27;c001&#x27; and ag&lt;&gt;20 and job =&#x27;it&#x27;;</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+--------------------------+</span><br><span class="line">| id | select_type | table | partitions | type  | possible_keys | key     | key_len | ref  | rows | filtered | Extra                    |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+--------------------------+</span><br><span class="line">|  1 | SIMPLE      | t2    | NULL       | range | pnagjob       | pnagjob | 773     | NULL |    2 |    12.50 | Using where; Using index |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+--------------------------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; explain select * from t2 where pn !=&#x27;c001&#x27;;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra       |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">|  1 | SIMPLE      | t2    | NULL       | ALL  | pnagjob       | NULL | NULL    | NULL |    8 |   100.00 | Using where |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; explain select * from t2 where pn&lt;&gt;&#x27;c001&#x27;;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra       |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">|  1 | SIMPLE      | t2    | NULL       | ALL  | pnagjob       | NULL | NULL    | NULL |    8 |   100.00 | Using where |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br></pre></td></tr></table></figure>
上边的三个sql<br>sql1:mysql&gt; explain select pn,ag,job from t2 where pn !&#x3D;’c001’;<br>sql2:mysql&gt; explain select pn,ag,job from t2 where pn &#x3D;’c001’ and ag&lt;&gt;20 and job &#x3D;’it’;<br>sql3:mysql&gt; explain select * from t2 where pn!&#x3D;’c001’;<br>sql4:mysql&gt; explain select * from t2 where pn&lt;&gt;’c001’;</li>
</ul>
<p>sql1和sql2因为进行了检索内容优化，因此看起来效率高于sql3和sql4<br>sql3和sql4 pn是索引列，因为使用了不等于，导致索引失效key&#x3D;NULL</p>
<ul>
<li>is null 和 is not null 也会导致索引失效<br><img src="/zhangyangibm/mysql/0008.png" alt="mysql" title="mysql"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; explain select * from t2 where pn is not null;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra       |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">|  1 | SIMPLE      | t2    | NULL       | ALL  | pnagjob       | NULL | NULL    | NULL |    8 |   100.00 | Using where |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; explain select * from t2 where pn is null;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+---------+---------+-------+------+----------+-----------------------+</span><br><span class="line">| id | select_type | table | partitions | type | possible_keys | key     | key_len | ref   | rows | filtered | Extra                 |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+---------+---------+-------+------+----------+-----------------------+</span><br><span class="line">|  1 | SIMPLE      | t2    | NULL       | ref  | pnagjob       | pnagjob | 768     | const |    1 |   100.00 | Using index condition |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+---------+---------+-------+------+----------+-----------------------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br></pre></td></tr></table></figure>
sql1:mysql&gt; explain select * from t2 where pn is not null;<br>sql2:mysql&gt; explain select * from t2 where pn is null;</li>
</ul>
<p><strong>注意</strong>这里发现sql2 is null 经过实际验证，查询索引没有失效, 其实这样的说法不准确。</p>
<ul>
<li>like “%”在最左边会导致索引失效，<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; explain select * from t2 where pn like &#x27;%00%&#x27;;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra       |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">|  1 | SIMPLE      | t2    | NULL       | ALL  | NULL          | NULL | NULL    | NULL |    8 |    12.50 | Using where |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">1 row in set, 1 warning (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; explain select * from t2 where pn like &#x27;%c00&#x27;;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra       |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">|  1 | SIMPLE      | t2    | NULL       | ALL  | NULL          | NULL | NULL    | NULL |    8 |    12.50 | Using where |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; explain select * from t2 where pn like &#x27;c00%&#x27;;</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-----------------------+</span><br><span class="line">| id | select_type | table | partitions | type  | possible_keys | key     | key_len | ref  | rows | filtered | Extra                 |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-----------------------+</span><br><span class="line">|  1 | SIMPLE      | t2    | NULL       | range | pnagjob       | pnagjob | 768     | NULL |    1 |   100.00 | Using index condition |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-----------------------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; explain select * from t2 where pn like &#x27;c%00%&#x27;;</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-----------------------+</span><br><span class="line">| id | select_type | table | partitions | type  | possible_keys | key     | key_len | ref  | rows | filtered | Extra                 |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-----------------------+</span><br><span class="line">|  1 | SIMPLE      | t2    | NULL       | range | pnagjob       | pnagjob | 768     | NULL |    1 |   100.00 | Using index condition |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-----------------------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
sql1:mysql&gt; explain select * from t2 where pn like ‘%00%’;<br>sql2:mysql&gt; explain select * from t2 where pn like ‘%c00’;<br>sql3:mysql&gt; explain select * from t2 where pn like ‘c00%’;<br>sql4:mysql&gt; explain select * from t2 where pn like ‘c%00%’;</li>
</ul>
<p>四条sql<br>sql1: like ‘%00%’ 导致了索引失效<br>sql2: like ‘%c00’ 导致了索引失效<br>sql3: like ‘c00%’ 没有失效<br>sql4: like ‘c%00%’ 没有失效</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; explain select job from t2 where pn like &#x27;%c00%&#x27;;</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+--------------------------+</span><br><span class="line">| id | select_type | table | partitions | type  | possible_keys | key     | key_len | ref  | rows | filtered | Extra                    |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+--------------------------+</span><br><span class="line">|  1 | SIMPLE      | t2    | NULL       | index | NULL          | pnagjob | 1541    | NULL |    8 |    12.50 | Using where; Using index |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+--------------------------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; explain select city from t2 where pn like &#x27;%c00%&#x27;;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra       |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">|  1 | SIMPLE      | t2    | NULL       | ALL  | NULL          | NULL | NULL    | NULL |    8 |    12.50 | Using where |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; explain select pn,city from t2 where pn like &#x27;%c00%&#x27;;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra       |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">|  1 | SIMPLE      | t2    | NULL       | ALL  | NULL          | NULL | NULL    | NULL |    8 |    12.50 | Using where |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>使用like查询的时候还有以上的情况保证 <strong>%xx%<strong>生效：就是</strong>当索引列在是检索内容</strong>的时候，注意一点！如果检索内只要有一个字段不是索引字段，那么索引就失效。<br>sql1:mysql&gt; explain select job from t2 where pn like ‘%c00%’;<br>sql2:mysql&gt; explain select city from t2 where pn like ‘%c00%’;<br>sql3:mysql&gt; explain select pn,city from t2 where pn like ‘%c00%’;</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">捕猹少年</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://gitee.com/zhangyangibm/zhangyangibm.git/2021/05/03/mysql%E6%95%B0%E6%8D%AE%E5%BA%93/">https://gitee.com/zhangyangibm/zhangyangibm.git/2021/05/03/mysql%E6%95%B0%E6%8D%AE%E5%BA%93/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://gitee.com/zhangyangibm/zhangyangibm.git" target="_blank">Gordo</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/zhangyangibm/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a><a class="post-meta__tags" href="/zhangyangibm/tags/Database/">Database</a><a class="post-meta__tags" href="/zhangyangibm/tags/mysql/">mysql</a></div><div class="post_share"><div class="social-share" data-image="/zhangyangibm/img/mysql.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/zhangyangibm/img/wechat.png" target="_blank"><img class="post-qr-code-img" src="/zhangyangibm/img/wechat.png" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/zhangyangibm/img/zhifubao.png" target="_blank"><img class="post-qr-code-img" src="/zhangyangibm/img/zhifubao.png" alt="zhifubao"/></a><div class="post-qr-code-desc">zhifubao</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/zhangyangibm/2021/12/24/Docker%20for%20Linux/"><img class="prev-cover" src="/zhangyangibm/img/docker.png" onerror="onerror=null;src='/zhangyangibm/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Docker for Liunx</div></div></a></div><div class="next-post pull-right"><a href="/zhangyangibm/2021/03/01/%E6%B5%85%E8%B0%88Swagger/"><img class="next-cover" src="/zhangyangibm/img/swagger.png" onerror="onerror=null;src='/zhangyangibm/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">浅谈Swagger</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/zhangyangibm/2020/01/01/Oracle%E5%85%B3%E9%94%AE%E5%AD%97/" title="oralce关键字"><img class="cover" src="/zhangyangibm/img/Oracle.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-01-01</div><div class="title">oralce关键字</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id="comment-switch"><span class="first-comment">Valine</span><span class="switch-btn"></span><span class="second-comment">Disqus</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/zhangyangibm/img/header.jpg" onerror="this.onerror=null;this.src='/zhangyangibm/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">捕猹少年</div><div class="author-info__description"></div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/zhangyangibm/archives/"><div class="headline">文章</div><div class="length-num">16</div></a></div><div class="card-info-data-item"><a href="/zhangyangibm/tags/"><div class="headline">标签</div><div class="length-num">34</div></a></div><div class="card-info-data-item"><a href="/zhangyangibm/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div></div><a id="card-info-btn" href="https://gitee.com/zhangyangibm/zhangyangibm"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:123456789gordo@sina.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">大家好，欢迎来到我的频道，<br>新频道从2022年正式Github迁移至Gitee，感谢您一如既往的关注和支持！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81Join"><span class="toc-number">2.</span> <span class="toc-text">1、Join</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81index"><span class="toc-number">3.</span> <span class="toc-text">2、index</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1%E3%80%81%E7%B4%A2%E5%BC%95%E7%9A%84%E4%BC%98%E5%8A%BF%E5%92%8C%E5%8A%A3%E5%8A%BF%EF%BC%9A"><span class="toc-number">3.1.</span> <span class="toc-text">2.1、索引的优势和劣势：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2%E3%80%81%E7%B4%A2%E5%BC%95%E5%88%86%E7%B1%BB"><span class="toc-number">3.2.</span> <span class="toc-text">2.2、索引分类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3%E3%80%81%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95"><span class="toc-number">3.3.</span> <span class="toc-text">2.3、基本语法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90"><span class="toc-number">4.</span> <span class="toc-text">3、性能分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4%E3%80%81%E9%81%BF%E5%85%8D%E7%B4%A2%E5%BC%95%E5%A4%B1%E6%95%88"><span class="toc-number">4.1.</span> <span class="toc-text">2.4、避免索引失效</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/zhangyangibm/2022/03/28/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/" title="分布式事务"><img src="/zhangyangibm/img/fenbushi.png" onerror="this.onerror=null;this.src='/zhangyangibm/img/404.jpg'" alt="分布式事务"/></a><div class="content"><a class="title" href="/zhangyangibm/2022/03/28/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/" title="分布式事务">分布式事务</a><time datetime="2022-03-28T05:30:00.000Z" title="发表于 2022-03-28 13:30:00">2022-03-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/zhangyangibm/2022/03/27/RabbitMq/" title="消息队列rabbitmq"><img src="/zhangyangibm/img/rabbitmq.png" onerror="this.onerror=null;this.src='/zhangyangibm/img/404.jpg'" alt="消息队列rabbitmq"/></a><div class="content"><a class="title" href="/zhangyangibm/2022/03/27/RabbitMq/" title="消息队列rabbitmq">消息队列rabbitmq</a><time datetime="2022-03-27T02:00:00.000Z" title="发表于 2022-03-27 10:00:00">2022-03-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/zhangyangibm/2021/12/24/Docker%20for%20Linux/" title="Docker for Liunx"><img src="/zhangyangibm/img/docker.png" onerror="this.onerror=null;this.src='/zhangyangibm/img/404.jpg'" alt="Docker for Liunx"/></a><div class="content"><a class="title" href="/zhangyangibm/2021/12/24/Docker%20for%20Linux/" title="Docker for Liunx">Docker for Liunx</a><time datetime="2021-12-24T14:49:47.000Z" title="发表于 2021-12-24 22:49:47">2021-12-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/zhangyangibm/2021/05/03/mysql%E6%95%B0%E6%8D%AE%E5%BA%93/" title="MySql"><img src="/zhangyangibm/img/mysql.png" onerror="this.onerror=null;this.src='/zhangyangibm/img/404.jpg'" alt="MySql"/></a><div class="content"><a class="title" href="/zhangyangibm/2021/05/03/mysql%E6%95%B0%E6%8D%AE%E5%BA%93/" title="MySql">MySql</a><time datetime="2021-05-03T04:47:47.000Z" title="发表于 2021-05-03 12:47:47">2021-05-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/zhangyangibm/2021/03/01/%E6%B5%85%E8%B0%88Swagger/" title="浅谈Swagger"><img src="/zhangyangibm/img/swagger.png" onerror="this.onerror=null;this.src='/zhangyangibm/img/404.jpg'" alt="浅谈Swagger"/></a><div class="content"><a class="title" href="/zhangyangibm/2021/03/01/%E6%B5%85%E8%B0%88Swagger/" title="浅谈Swagger">浅谈Swagger</a><time datetime="2021-03-01T14:47:47.000Z" title="发表于 2021-03-01 22:47:47">2021-03-01</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/zhangyangibm/img/top_img.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By 捕猹少年</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to <a target="_blank" rel="noopener" href="https://zhangyangibm.gitee.io/">ZHY.Channel</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/zhangyangibm/js/utils.js"></script><script src="/zhangyangibm/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: '',
      appKey: '',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script>function loadDisqus () {
  var disqus_config = function () {
    this.page.url = 'https://gitee.com/zhangyangibm/zhangyangibm.git/2021/05/03/mysql%E6%95%B0%E6%8D%AE%E5%BA%93/'
    this.page.identifier = '2021/05/03/mysql数据库/'
    this.page.title = 'MySql'
  };

  window.disqusReset = () => {
    DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  if (window.DISQUS) disqusReset()
  else {
    (function() { 
      var d = document, s = d.createElement('script');
      s.src = 'https://.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  }
}

if ('Valine' === 'Disqus' || !false) {
  if (false) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
  else loadDisqus()
} else {
  function loadOtherComment () {
    loadDisqus()
  }
}
</script></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>